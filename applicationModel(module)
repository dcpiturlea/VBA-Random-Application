


'function for sleep 'thread'
Private Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long)

Sub Delay(s As Single)
    Dim TimeOut As Single
    TimeOut = Timer + s
    Do While Timer < TimeOut
        DoEvents
        Sleep 0.5
    Loop
End Sub


Function AlegereLocalitate() As Dictionary
Dim lastC As Integer
Dim lastR As Integer
lastC = ThisWorkbook.ActiveSheet.Cells(1, 1).End(xlToRight).Column
lastR = ThisWorkbook.ActiveSheet.Cells(1, 1).End(xlDown).Row

    
Dim rngSelection As Range
Dim rngCell As Range
Dim strRange As String
strRange = "A1:B" & lastR
Set rngSelection = ThisWorkbook.Sheets(1).Range(strRange)

Dim cityDictionary As Object
Set cityDictionary = CreateObject("Scripting.Dictionary")

Dim i As Integer

For i = 2 To lastR
    cityDictionary.Add rngSelection.Cells(i, 1), rngSelection.Cells(i, 2)
Next i

Set AlegereLocalitate = cityDictionary
End Function



Function ramdomLocatlitate(cityDictionary As Dictionary) As String
    Dim random_number As Integer

    random_number = Application.WorksheetFunction.RandBetween(1, cityDictionary.Count)
    
    Dim i As Integer
    For i = 0 To cityDictionary.Count - 1
        If cityDictionary.Keys()(i) = random_number Then
        ramdomLocatlitate = cityDictionary.Items()(i)
        
        End If
    Next i


End Function



Sub test()

MsgBox ramdomLocatlitate(AlegereLocalitate)

End Sub


Public Sub startApp()
Application.Visible = False
UserForm1.Show

End Sub
